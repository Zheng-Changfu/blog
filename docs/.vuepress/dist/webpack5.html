<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack-5 个人笔记 | 小惠喜欢常富</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="始终坚信努力可以改变生活">
    
    <link rel="preload" href="/assets/css/0.styles.7cfabf05.css" as="style"><link rel="preload" href="/assets/js/app.a1291d4f.js" as="script"><link rel="preload" href="/assets/js/2.ea471770.js" as="script"><link rel="preload" href="/assets/js/19.dcb77355.js" as="script"><link rel="prefetch" href="/assets/js/10.314ac4fc.js"><link rel="prefetch" href="/assets/js/11.9849ee1a.js"><link rel="prefetch" href="/assets/js/12.d0653dc5.js"><link rel="prefetch" href="/assets/js/13.a9357fd0.js"><link rel="prefetch" href="/assets/js/14.5189ee32.js"><link rel="prefetch" href="/assets/js/15.9afd2d44.js"><link rel="prefetch" href="/assets/js/16.73c07708.js"><link rel="prefetch" href="/assets/js/17.c40fd96c.js"><link rel="prefetch" href="/assets/js/18.04c24c57.js"><link rel="prefetch" href="/assets/js/3.bd24ab4e.js"><link rel="prefetch" href="/assets/js/4.05f254cc.js"><link rel="prefetch" href="/assets/js/5.302a20c7.js"><link rel="prefetch" href="/assets/js/6.c5f5f561.js"><link rel="prefetch" href="/assets/js/7.1010668f.js"><link rel="prefetch" href="/assets/js/8.58cc504b.js"><link rel="prefetch" href="/assets/js/9.97948b8b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7cfabf05.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小惠喜欢常富</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/node.html" class="nav-link">
  Node笔记
</a></div><div class="nav-item"><a href="/regexp.html" class="nav-link">
  正则(RegExp)笔记
</a></div><div class="nav-item"><a href="/typescript.html" class="nav-link">
  Typescript笔记
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架笔记" class="dropdown-title"><span class="title">框架笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架笔记" class="mobile-dropdown-title"><span class="title">框架笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue2.html" class="nav-link">
  Vue2笔记
</a></li><li class="dropdown-item"><!----> <a href="/vue3.html" class="nav-link">
  Vue3笔记
</a></li><li class="dropdown-item"><!----> <a href="/react.html" class="nav-link">
  React笔记
</a></li><li class="dropdown-item"><!----> <a href="/dva.html" class="nav-link">
  Dva笔记
</a></li><li class="dropdown-item"><!----> <a href="/umi.html" class="nav-link">
  Umi笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="构建笔记" class="dropdown-title"><span class="title">构建笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="构建笔记" class="mobile-dropdown-title"><span class="title">构建笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webpack5.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Webpack笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库笔记" class="dropdown-title"><span class="title">数据库笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库笔记" class="mobile-dropdown-title"><span class="title">数据库笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mysql.html" class="nav-link">
  Mysql笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维部署笔记" class="dropdown-title"><span class="title">运维部署笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="运维部署笔记" class="mobile-dropdown-title"><span class="title">运维部署笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux.html" class="nav-link">
  Linux笔记
</a></li><li class="dropdown-item"><!----> <a href="/nginx.html" class="nav-link">
  Nginx笔记
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Zheng-Changfu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/node.html" class="nav-link">
  Node笔记
</a></div><div class="nav-item"><a href="/regexp.html" class="nav-link">
  正则(RegExp)笔记
</a></div><div class="nav-item"><a href="/typescript.html" class="nav-link">
  Typescript笔记
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架笔记" class="dropdown-title"><span class="title">框架笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架笔记" class="mobile-dropdown-title"><span class="title">框架笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue2.html" class="nav-link">
  Vue2笔记
</a></li><li class="dropdown-item"><!----> <a href="/vue3.html" class="nav-link">
  Vue3笔记
</a></li><li class="dropdown-item"><!----> <a href="/react.html" class="nav-link">
  React笔记
</a></li><li class="dropdown-item"><!----> <a href="/dva.html" class="nav-link">
  Dva笔记
</a></li><li class="dropdown-item"><!----> <a href="/umi.html" class="nav-link">
  Umi笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="构建笔记" class="dropdown-title"><span class="title">构建笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="构建笔记" class="mobile-dropdown-title"><span class="title">构建笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webpack5.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Webpack笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库笔记" class="dropdown-title"><span class="title">数据库笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库笔记" class="mobile-dropdown-title"><span class="title">数据库笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mysql.html" class="nav-link">
  Mysql笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维部署笔记" class="dropdown-title"><span class="title">运维部署笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="运维部署笔记" class="mobile-dropdown-title"><span class="title">运维部署笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux.html" class="nav-link">
  Linux笔记
</a></li><li class="dropdown-item"><!----> <a href="/nginx.html" class="nav-link">
  Nginx笔记
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/Zheng-Changfu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  个人github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Webpack-5 个人笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/webpack5.html#_1-基础" class="sidebar-link">1. 基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webpack5.html#_1-核心概念" class="sidebar-link">1. 核心概念</a></li><li class="sidebar-sub-header"><a href="/webpack5.html#_2-环境变量" class="sidebar-link">2. 环境变量</a></li><li class="sidebar-sub-header"><a href="/webpack5.html#_3-开发服务器" class="sidebar-link">3. 开发服务器</a></li><li class="sidebar-sub-header"><a href="/webpack5.html#_4-use-的三种格式" class="sidebar-link">4. use 的三种格式</a></li><li class="sidebar-sub-header"><a href="/webpack5.html#_5-loader" class="sidebar-link">5. loader</a></li><li class="sidebar-sub-header"><a href="/webpack5.html#_6-css-兼容性处理" class="sidebar-link">6. css 兼容性处理</a></li><li class="sidebar-sub-header"><a href="/webpack5.html#_7-js-兼容性处理" class="sidebar-link">7. js 兼容性处理</a></li><li class="sidebar-sub-header"><a href="/webpack5.html#_8-sourcemap-源映射" class="sidebar-link">8. sourcemap(源映射)</a></li><li class="sidebar-sub-header"><a href="/webpack5.html#_9-打包第三方类库" class="sidebar-link">9. 打包第三方类库</a></li><li class="sidebar-sub-header"><a href="/webpack5.html#_10-webpack-dev-server" class="sidebar-link">10. webpack-dev-server</a></li><li class="sidebar-sub-header"><a href="/webpack5.html#_11-提取-css" class="sidebar-link">11. 提取 css</a></li><li class="sidebar-sub-header"><a href="/webpack5.html#_12-三种-hash-值的区别" class="sidebar-link">12. 三种 hash 值的区别</a></li><li class="sidebar-sub-header"><a href="/webpack5.html#_13-px2rem-loader" class="sidebar-link">13. px2rem-loader</a></li></ul></li><li><a href="/webpack5.html#_2-深入" class="sidebar-link">2. 深入</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack-5-个人笔记"><a href="#webpack-5-个人笔记" class="header-anchor">#</a> Webpack-5 个人笔记</h1> <h2 id="_1-基础"><a href="#_1-基础" class="header-anchor">#</a> 1. 基础</h2> <h3 id="_1-核心概念"><a href="#_1-核心概念" class="header-anchor">#</a> 1. 核心概念</h3> <ul><li>entry(入口) : 指示 webpack 应该使用哪个模块，来作为构建其内部 依赖图 的开始</li> <li>output(出口) : 告诉 webpack 在哪里输出它所创建的 bundle，以及如何命名这些文件</li> <li>loader : webpack 只能理解 JavaScript 和 JSON 文件，loader 让 webpack 能够去处理其他类型的文件</li> <li>plugin : loader 用于转换某些类型的模块，而插件则可以用于执行范围更广的任务。包括：打包优化，资源管理，注入环境变量</li> <li>mode : 通过选择 development, production 或 none 之中的一个，来设置 mode 参数，你可以启用 webpack 内置在相应环境下的优化。其默认值为 production</li></ul> <h3 id="_2-环境变量"><a href="#_2-环境变量" class="header-anchor">#</a> 2. 环境变量</h3> <ol><li>--mode 用来设置模块内的 <code>process.env.NODE_ENV</code></li> <li>--env 用来设置 webpack 配置文件的函数参数，配置文件要写成函数形式</li> <li>DefinePlugin 用来设置模块内的全局变量,是 webpack 的一个插件</li> <li>cross-env 用来设置 node 环境的 <code>process.env.NODE_ENV</code>,也是比较常用的</li></ol> <h3 id="_3-开发服务器"><a href="#_3-开发服务器" class="header-anchor">#</a> 3. 开发服务器</h3> <h4 id="_3-1-理解以下-path-的作用及区别"><a href="#_3-1-理解以下-path-的作用及区别" class="header-anchor">#</a> 3.1 理解以下 path 的作用及区别</h4> <table><thead><tr><th>类别</th> <th>配置名称</th> <th>描述</th> <th>配置</th> <th>打包后</th></tr></thead> <tbody><tr><td>output</td> <td>path</td> <td>输出到硬盘上的目录路径</td> <td><img src="/assets/output.png" alt=""></td> <td><img src="/assets/output-result.png" alt=""></td></tr> <tr><td>output</td> <td>publicPath</td> <td>打包生成的 html 文件里面引用的资源路径前缀</td> <td><img src="/assets/output-publicPath.png" alt=""></td> <td><img src="/assets/output-publicPath-result.png" alt=""></td></tr> <tr><td>devServer</td> <td>publicPath</td> <td>同 output.publicPath 一样，只不过优先级比它高</td> <td>同 output.publicPath</td> <td>同 output.publicPath</td></tr> <tr><td>devServer</td> <td>contentBase</td> <td>用于配置额外静态文件内容目录的路径</td> <td><img src="/assets/content-base.png" style="zoom:200%;"></td> <td><img src="/assets/content-base-result.png" style="zoom:200%;"></td></tr></tbody></table> <h3 id="_4-use-的三种格式"><a href="#_4-use-的三种格式" class="header-anchor">#</a> 4. use 的三种格式</h3> <ol><li>字符串格式: 一个 loader 的时候可以</li> <li>数组格式: 多个 loader 的时候可以, (从下往上|从右往左)依次执行</li> <li>对象格式: 给 loader 传参的时候可以用，一般写 options，options 里面的配置会传递给 loader</li></ol> <h3 id="_5-loader"><a href="#_5-loader" class="header-anchor">#</a> 5. loader</h3> <table><thead><tr><th>loader</th> <th>意义</th> <th>js-code</th> <th>配置</th> <th>打包后</th></tr></thead> <tbody><tr><td>raw-loader</td> <td>解析原始文件</td> <td><img src="/assets/raw-loader-code.png" alt=""></td> <td><img src="/assets/raw-loader.png" alt=""></td> <td><img src="/assets/raw-loader-result.png" alt=""></td></tr> <tr><td>css-loader</td> <td>解析@import 和 url</td> <td><img src="/assets/css-loader-result.png" alt=""></td> <td><img src="/assets/css-loader.png" alt=""></td> <td></td></tr> <tr><td>style-loader</td> <td>将 css 插入到 DOM 中</td> <td></td> <td><img src="/assets/css-loader.png" alt=""></td> <td><img src="/assets/style-loader-result.png" style="zoom:200%;"></td></tr> <tr><td>file-loader</td> <td>拷贝图片至打包目录下</td> <td></td> <td><img src="/assets/file-loader.png" alt=""></td> <td><img src="/assets/file-loader-result.png" alt=""></td></tr> <tr><td>url-loader</td> <td>当图片小于<code>limit</code>的时候会把图片<code>BASE64</code>编码，大于<code>limit</code>参数的时候还是使用<code>file-loader</code>进行拷贝</td> <td></td> <td><img src="/assets/url-loader.png" alt=""></td> <td></td></tr></tbody></table> <h3 id="_6-css-兼容性处理"><a href="#_6-css-兼容性处理" class="header-anchor">#</a> 6. css 兼容性处理</h3> <h4 id="_6-1-安装"><a href="#_6-1-安装" class="header-anchor">#</a> 6.1 安装</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> postcss-loader autoprefixer -D
</code></pre></div><h4 id="_6-2-配置"><a href="#_6-2-配置" class="header-anchor">#</a> 6.2 配置</h4> <p><img src="/assets/postcss-loader.png" alt=""></p> <p><img src="/assets/postcss.config.js.png" alt=""></p> <h4 id="_6-3-结果"><a href="#_6-3-结果" class="header-anchor">#</a> 6.3 结果</h4> <p><img src="/assets/postcss-loader-result.png" alt=""></p> <h3 id="_7-js-兼容性处理"><a href="#_7-js-兼容性处理" class="header-anchor">#</a> 7. js 兼容性处理</h3> <h4 id="_7-1-安装"><a href="#_7-1-安装" class="header-anchor">#</a> 7.1 安装</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i babel-loader @babel/core @babel/preset-env -D
</code></pre></div><h4 id="_7-2-包说明"><a href="#_7-2-包说明" class="header-anchor">#</a> 7.2 包说明</h4> <blockquote><p>babel-loader : 不知道如何处理和转换 js 代码，内部会调用 @babel/core</p> <p>@babel/core : 认识 js 代码，但是不知道怎么转换，内部会调用 @babel/preset-env</p> <p>@babel/preset-env : 插件的集合被打成了一个包，这个包就叫预设，可以将高级语法转换成低级语法</p></blockquote> <h3 id="_8-sourcemap-源映射"><a href="#_8-sourcemap-源映射" class="header-anchor">#</a> 8. sourcemap(源映射)</h3> <h4 id="_8-1-基本认识"><a href="#_8-1-基本认识" class="header-anchor">#</a> 8.1 基本认识</h4> <table><thead><tr><th>关键字</th> <th>含义</th></tr></thead> <tbody><tr><td>source-map</td> <td>产生.map 的映射文件</td></tr> <tr><td>eval</td> <td>使用 eval 函数包裹模块代码</td></tr> <tr><td>cheap</td> <td>不包含列信息，也不包含 loader 的 sourcemap</td></tr> <tr><td>module</td> <td>包含 loader 的 sourcemap，否则无法映射到源文件</td></tr> <tr><td>inline</td> <td>将.map 作为 DataURL 嵌入，不单独生成.map 文件</td></tr></tbody></table> <ul><li>以上模式可以进行任意组合</li></ul> <h4 id="_8-2-开启-source-map-模式"><a href="#_8-2-开启-source-map-模式" class="header-anchor">#</a> 8.2 开启 source-map 模式</h4> <h5 id="_8-2-1-源代码"><a href="#_8-2-1-源代码" class="header-anchor">#</a> 8.2.1 源代码</h5> <p><img src="/assets/source-map.png" alt=""></p> <h5 id="_8-2-2-编译后目录"><a href="#_8-2-2-编译后目录" class="header-anchor">#</a> 8.2.2 编译后目录</h5> <p><img src="/assets/source-map-dist.png" alt=""></p> <h5 id="_8-2-3-bundle-js"><a href="#_8-2-3-bundle-js" class="header-anchor">#</a> 8.2.3 bundle.js</h5> <p><img src="/assets/source-map-bundle-code.png" alt=""></p> <h5 id="_8-2-4-bundle-js-map"><a href="#_8-2-4-bundle-js-map" class="header-anchor">#</a> 8.2.4 bundle.js.map</h5> <p><img src="/assets/source-map-bundle-map-code.png" alt=""></p> <h5 id="_8-2-5-增加错误代码"><a href="#_8-2-5-增加错误代码" class="header-anchor">#</a> 8.2.5 增加错误代码</h5> <p><img src="/assets/source-map-error-code.png" alt=""></p> <h5 id="_8-2-6-浏览器控制台定位到的错误信息"><a href="#_8-2-6-浏览器控制台定位到的错误信息" class="header-anchor">#</a> 8.2.6 浏览器控制台定位到的错误信息</h5> <p><img src="/assets/source-map-error-code-result1.png" alt=""></p> <p><img src="/assets/source-map-error-code-result2.png" alt=""></p> <h4 id="_8-3-开启-eval-模式"><a href="#_8-3-开启-eval-模式" class="header-anchor">#</a> 8.3 开启 eval 模式</h4> <ul><li>eval 模式 和 source-map 差不多，eval 可以用来做缓存，后续构建速度更快，生成的.map 映射文件内容都是一样的</li></ul> <h5 id="_8-3-1-bundle-js"><a href="#_8-3-1-bundle-js" class="header-anchor">#</a> 8.3.1 bundle.js</h5> <p><img src="/assets/eval.png" alt=""></p> <h4 id="_8-4-开启-cheap-source-map-模式"><a href="#_8-4-开启-cheap-source-map-模式" class="header-anchor">#</a> 8.4 开启 cheap-source-map 模式</h4> <h5 id="_8-4-1-bundle-js"><a href="#_8-4-1-bundle-js" class="header-anchor">#</a> 8.4.1 bundle.js</h5> <p><img src="/assets/source-map-bundle-code.png" alt=""></p> <h5 id="_8-4-2-bundle-js-map"><a href="#_8-4-2-bundle-js-map" class="header-anchor">#</a> 8.4.2 bundle.js.map</h5> <p><img src="/assets/cheap-bundle-map-code.png" alt=""></p> <h5 id="_8-4-3-浏览器控制台定位到的错误信息"><a href="#_8-4-3-浏览器控制台定位到的错误信息" class="header-anchor">#</a> 8.4.3 浏览器控制台定位到的错误信息</h5> <p><img src="/assets/cheap-error-code-result.png" alt=""></p> <h4 id="_8-5-开启-inline-source-map-模式"><a href="#_8-5-开启-inline-source-map-模式" class="header-anchor">#</a> 8.5 开启 inline-source-map 模式</h4> <h5 id="_8-5-1-bundle-js-无-map-文件"><a href="#_8-5-1-bundle-js-无-map-文件" class="header-anchor">#</a> 8.5.1 bundle.js(无.map 文件)</h5> <p><img src="/assets/inline.png" alt=""></p> <h4 id="_8-6-source-map-图解"><a href="#_8-6-source-map-图解" class="header-anchor">#</a> 8.6 source-map 图解</h4> <p><img src="/assets/source-map-process.png" alt=""></p> <h4 id="_8-7-cheap-source-map-图解"><a href="#_8-7-cheap-source-map-图解" class="header-anchor">#</a> 8.7 cheap-source-map 图解</h4> <p><img src="/assets/cheap-source-map-process.png" alt=""></p> <h4 id="_8-8-cheap-module-source-map-图解"><a href="#_8-8-cheap-module-source-map-图解" class="header-anchor">#</a> 8.8 cheap-module-source-map 图解</h4> <p><img src="/assets/cheap-module-source-map-process.png" alt=""></p> <h4 id="_8-9-sourcemap-最佳实践"><a href="#_8-9-sourcemap-最佳实践" class="header-anchor">#</a> 8.9 sourcemap 最佳实践</h4> <h5 id="_8-9-1-组合规则"><a href="#_8-9-1-组合规则" class="header-anchor">#</a> 8.9.1 组合规则</h5> <table><thead><tr><th>组合(规则)</th> <th>解释</th></tr></thead> <tbody><tr><td>[inline-|hidden-|eval-][nosources-][cheap-[module-]]source-map</td> <td>组合规则强制要求顺序</td></tr> <tr><td>source-map</td> <td>会在外部生成单独的 sourcemap 文件，会与源代码文件进行关联，能提示代码的准确原始位置</td></tr> <tr><td>inline-source-map</td> <td>以 base64 格式内联在打包后的文件中，内联构建速度快、也能提示错误代码的准确原始位置</td></tr> <tr><td>hidden-source-map</td> <td>会在外部生成单独的 sourcemap 文件，但是不和源代码文件进行关联，不能提示错误代码的准确原始位置</td></tr> <tr><td>eval-source-map</td> <td>会给每一个模块生成单独的 sourcemap 文件进行内联，并使用 eval 执行</td></tr> <tr><td>nosources-source-map</td> <td>会在外部生成 sourcemap 文件，能找到源代码位置，但是源代码内容为空</td></tr> <tr><td>cheap-source-map</td> <td>会在外部生成 sourcemap 文件，不包含列和 loader 的 map 信息</td></tr> <tr><td>cheap-module-source-map</td> <td>会在外部生成 sourcemap 文件，不包含列的信息</td></tr></tbody></table> <h5 id="_8-9-2-开发环境"><a href="#_8-9-2-开发环境" class="header-anchor">#</a> 8.9.2 开发环境</h5> <ol><li>速度快：<code>eval-cheap-source-map</code></li> <li>调试友好：<code>eval-cheap-module-source-map</code></li> <li>推荐：<code>eval-source-map</code></li></ol> <h5 id="_8-9-3-生产环境"><a href="#_8-9-3-生产环境" class="header-anchor">#</a> 8.9.3 生产环境</h5> <ol><li>速度快：<code>cheap</code></li> <li>调试友好：<code>[source-map]&gt;[cheap-source-map | cheap-module-source-map]&gt;[hideen-source-map | nosources-source-map]</code></li> <li>推荐：<code>hidden-source-map</code>,会生成<code>sourcemap</code>文件，但是不进行关联、不会上传关联信息</li></ol> <h5 id="_8-9-4-开发环境调试"><a href="#_8-9-4-开发环境调试" class="header-anchor">#</a> 8.9.4 开发环境调试</h5> <ol><li><p>本地代码编辑器内调试</p></li> <li><p>通过 source 控制器调试</p> <ul><li>右键打开控制台</li></ul></li></ol> <ul><li><p>选择 sources
<img src="/assets/debugger-source-map-dev.png" alt=""></p> <ul><li><p>右键<code>top</code>，选择<code>Search in all files</code></p> <p><img src="/assets/debugger-source-map-dev-search-files.png" alt=""></p></li> <li><p>搜索你想搜的代码</p> <p><img src="/assets/debugger-source-map-search-code.png" alt=""></p> <p><img src="/assets/debugger-source-map-search-result.png" alt=""></p></li></ul></li></ul> <h5 id="_8-9-5-测试环境调试"><a href="#_8-9-5-测试环境调试" class="header-anchor">#</a> 8.9.5 测试环境调试</h5> <blockquote><p>通过<code>source-map-dev-tool-plugin</code>进行细粒度的控制</p></blockquote> <ul><li><p>步骤一：设置<code>devtool:false</code>关闭</p> <p><img src="/assets/set-devtool-false.png" alt=""></p></li> <li><p>步骤二：通过<code>webpack.source-map-dev-tool-plugin</code>来生成 sourcemap 文件，并进行相关设置</p> <p><img src="/assets/source-map-dev-tool-plugin.png" alt=""></p></li> <li><p>步骤三：通过<code>filemanager-plugin插件</code>来拷贝源映射文件到其他目录，并删除原来的源映射文件，因为测试时我们的代码需要打包，打包生成的目录发给测试，其他的不需要发给测试，打包目录中没有源映射文件等敏感信息的</p> <p><img src="/assets/file-manager-plugin.png" alt=""></p></li> <li><p>步骤四：本地启动一个服务，如: <code>http-server</code>，保证通过端口号能访问到拷贝后的源映射文件即可，这样就可以进行调试了</p> <p><img src="/assets/http-server.png" alt=""></p></li> <li><p>步骤五：查看源代码</p> <p><img src="/assets/source-mapping-url.png" alt=""></p></li> <li><p>步骤六：增加断点调试，大功告成</p> <p><img src="/assets/debugger-source-map.png" alt=""></p></li></ul> <blockquote><p>总结：</p> <p>​ 优点：安全，只能你一个人调试，别人是调试不了的，除非你共享了拷贝后的源映射文件</p> <p>​ 缺点：有点点小麻烦</p></blockquote> <h5 id="_8-9-6-生产环境调试"><a href="#_8-9-6-生产环境调试" class="header-anchor">#</a> 8.9.6 生产环境调试</h5> <p><code>说明: 生产环境是没有map文件的，为了隐私安全</code></p> <ul><li><p>步骤一：修改环境为生产环境,真实项目可通过环境变量来区分</p> <p><img src="/assets/set-mode-production.png" alt=""></p></li> <li><p>步骤二：修改<code>devtool:hidden-source-map</code>，会生成 sourcemap 文件，我们<code>步骤三</code>会进行删除</p> <p><img src="/assets/set-devtool-hidden-source-map.png" alt=""></p></li> <li><p>步骤三：拷贝 sourcemap 文件至另外目录，删除打包目录中的 sourcemap 文件</p> <p><img src="/assets/copy-source-map-delete-dist-source-map.png" alt=""></p></li> <li><p>步骤四：开启本地服务，如：http-server，只要保证能访问到 sourcemap 文件即可</p> <p><img src="/assets/http-server.png" alt=""></p></li> <li><p>步骤五：sources 开启调试</p> <ul><li>打开 sources</li></ul> <p><img src="/assets/debugger-source-map-dev.png" alt=""></p> <ul><li><p>设置-勾选<code>Enabled Javascript source maps</code>选项</p> <p><img src="/assets/debugger-source-map-prod-settings.png" alt=""></p> <p><img src="/assets/debugger-source-map-settings-enabled.png" alt=""></p></li> <li><p>手动添加<code>source-map</code>文件地址进行关联</p> <p><img src="/assets/choose-source-map-address.png" alt=""></p> <p><img src="/assets/add-source-map-address.png" alt=""></p> <p><img src="/assets/add-source-map-address-result.png" alt=""></p> <p><img src="/assets/add-source-map-address-result-code.png" alt=""></p></li></ul></li></ul> <blockquote><p>总结：</p> <p>​ 优点：安全性高、可以把 sourcemap 文件放在本地或者安全的服务器上，保证不会泄露就行，调试方便</p> <p>​ 缺点：调试前的准备工作稍多</p></blockquote> <h3 id="_9-打包第三方类库"><a href="#_9-打包第三方类库" class="header-anchor">#</a> 9. 打包第三方类库</h3> <h3 id="_10-webpack-dev-server"><a href="#_10-webpack-dev-server" class="header-anchor">#</a> 10. webpack-dev-server</h3> <h3 id="_11-提取-css"><a href="#_11-提取-css" class="header-anchor">#</a> 11. 提取 css</h3> <h3 id="_12-三种-hash-值的区别"><a href="#_12-三种-hash-值的区别" class="header-anchor">#</a> 12. 三种 hash 值的区别</h3> <h3 id="_13-px2rem-loader"><a href="#_13-px2rem-loader" class="header-anchor">#</a> 13. px2rem-loader</h3> <h2 id="_2-深入"><a href="#_2-深入" class="header-anchor">#</a> 2. 深入</h2></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a1291d4f.js" defer></script><script src="/assets/js/2.ea471770.js" defer></script><script src="/assets/js/19.dcb77355.js" defer></script>
  </body>
</html>
